<html>
<head>
    <meta charset="utf-8">
    <script src="https://local/highstock.js"></script>
    <script src="https://local/data.js"></script>
    <script src="https://local/exporting.js"></script>
    <script src="https://local/export-data.js"></script>
    <script src="https://local/accessibility.js"></script>
</head>

<style>
    body {
        margin: 0 auto;
    }

    #container {
        display: flex;
        height: calc(100vh - 0px);
        margin: 0px;
        padding: 0px;
    }
</style>

<div id="container"></div>

<body>
    <!-- <script src="https://library/highstock.js"></script>
    <script src="https://library/data.js"></script>
    <script src="https://library/exporting.js"></script>
    <script src="https://library/export-data.js"></script>
    <script src="https://library/accessibility.js"></script> -->

    <script>
        let elevationData = [];
        let colors = [
            '#0000CC',
            '#FC0000',
            '#008200',
            '#00FCFC',
            '#480280',
            '#686868',
            '#884410',
            '#FC4400',
            '#808200',
            '#3CB070'
        ]

        Highcharts.setOptions({
            lang: {
                months: ['Январь', 'Февраль', 'Март', 'Апрель', 'Май', 'Июнь', 'Июль',
                    'Август', 'Сентябрь', 'Октябрь', 'Ноябрь', 'Декабрь'],
                shortWeekdays: ['ВС', 'ПН', 'ВТ', 'СР', 'ЧТ', 'ПТ', 'СБ'],
                weekdays: [
                    'Воскресенье',
                    'Понедельник',
                    'Вторник',
                    'Среда',
                    'Четверг',
                    'Пятница',
                    'Суббота'
                ],
                shortMonths: [
                    'Янв',
                    'Февр',
                    'Март',
                    'Апр',
                    'Май',
                    'Июнь',
                    'Июль',
                    'Авг',
                    'Сент',
                    'Окт',
                    'Нояб',
                    'Дек'
                ],
                loading: 'Загрузка...',
                decimalPoint: '.',
                resetZoom: 'Сброс масштаба'
            }
        });

        let chart = Highcharts.stockChart('container', {
            colors: colors,
            rangeSelector: {
                buttons: [{
                    type: 'minute',
                    count: 1,
                    text: '1мин'
                }, {
                    type: 'minute',
                    count: 10,
                    text: '10мин'
                }, {
                    type: 'minute',
                    count: 15,
                    text: '15мин'
                }, {
                    type: 'minute',
                    count: 30,
                    text: '30мин'
                }, {
                    type: 'hour',
                    count: 1,
                    text: '1ч'
                }, {
                    type: 'hour',
                    count: 2,
                    text: '2ч'
                }, {
                    type: 'hour',
                    count: 3,
                    text: '3ч'
                }, {
                    type: 'hour',
                    count: 6,
                    text: '6ч'
                }, {
                    type: 'hour',
                    count: 12,
                    text: '12ч'
                }, {
                    type: 'day',
                    count: 1,
                    text: '1д'
                }, {
                    type: 'day',
                    count: 2,
                    text: '2д'
                }, {
                    type: 'week',
                    text: '1нед'
                }, {
                    type: 'all',
                    text: 'все'
                }],
                inputEnabled: false, // Включает/отключает диапазон от и до, по дате
            },
            credits: {
                enabled: false
            },
            legend: {
                enabled: true,
                layout: 'vertical',
                align: 'left',
                verticalAlign: 'middle',
                itemMarginTop: 10,
                itemMarginBottom: 10
            },
            navigator: {
                opposite: false
            },
            chart: {
                zooming: {
                    mouseWheel: {
                        enabled: false // Отключает приближение на колесо мышки
                    }
                },
                plotBorderWidth: 1,
                plotBorderColor: '#000000',
                zoomType: 'xy', // Приближение выделенной зоны по оси x и y
            },
            tooltip: { // Всплывающее меню
                // Форматирование контекстного(всплывающего) меню
                formatter: function () {
                    var tooltip = Highcharts.dateFormat('%Y-%m-%d %H:%M:%S', this.x) + '<br>';
                    this.points.forEach(function (point) {
                        tooltip += '<span style="color:' + point.series.color + ';">' +
                            point.series.name + ': ' + Highcharts.numberFormat(point.y, 2) +
                                '<br>';
                    });

                    return tooltip;
                },
                shared: true,
                split: false,
                useHTML: true,
                headerFormat: '<span style="font-size: 15px; color: black;">{point}</span><br/>',
                style: {
                    fontWeight: 'bold',
                    fontSize: '15px'
                }
            },
            scrollbar: {
                enabled: false
            },
            navigation: {
                panning: false,
                buttonOptions: {
                    enabled: false // Выключает контекстное меню
                }
            },
            plotOptions: {
                series: {
                    marker: {
                        states: {
                            hover: {
                                enabled: false // Отключение точек на графике при наведении
                            }
                        }
                    },
                    showInNavigator: true
                },
            },
            xAxis: {
                // tickPixelInterval: getTickPixelInterval(),

                gridLineWidth: 1, // Толщина линий разделения
                labels: {
                    formatter: function() {
                        return Highcharts.dateFormat('%Y.%m.%d %H:%M:%S', this.value);
                    }
                },
                // tickInterval: 100000000,
                events: {
                    afterSetExtremes: function (e) {
                        // Разделение графика по оси x на равные части серыми линиями
                        // console.log('e.max: ', e.max, '\ne.min: ', e.min)
                        console.log('who is e: ', e)
                        var totalRange = e.max - e.min;
                        console.log('totalRange: ', totalRange)
                        var tickInterval = totalRange / 5;
                        console.log('tickInterval: ', tickInterval)
                        this.update({
                            tickInterval: totalRange / 4
                        });

                        // // Ленивая загрузка данных при изменении диапазона графика
                        // var chart = this.chart;
                        // var series = chart.series[0];
                        // var min = Math.floor(e.min);
                        // var max = Math.ceil(e.max);

                        // var newData = [
                        //     [min, Math.random() * 10],
                        //     [max, Math.random() * 10]
                        //     // Сюда можно добавить точки для оптимизации
                        // ];

                        // // Добавление полученных данных в серию
                        // series.setData(newData);
                    }
                },
            },
            // Это разделение оси y на две разных части левой и правой, в которой создаем
            // свойства для индикаторов по левой и правой стороне
            yAxis: [{
                // tickAmount: 5,
                opposite: false,
                labels: {
                    align: 'right',
                    format: '{value}'
                }
            }, {
                opposite: true,
                linkedTo: 0,
                labels: {
                    align: 'left',
                    format: '{value}'
                }
            }],
            boost: {
                enabled: true
            }
        })

        // // Функция для определения значения tickPixelInterval, нужна для определения количества
        // // серых линий по оси X
        // function getTickPixelInterval() {
        //     let windowWidth = window.innerWidth;
        //     console.log('width: ', windowWidth)
        //     if (windowWidth > 1600) {
        //         return 400;
        //     } else {
        //         return 200;
        //     }
        // }

        // // Обновление параметра tickPixelInterval при изменении размера окна
        // window.addEventListener('resize', function() {
        //     let newTickInterval = getTickPixelInterval();

        //     chart.xAxis[0].update({
        //         tickPixelInterval: newTickInterval
        //     });
        // });

        // let data = [{
        //    name: 'The Local Bakery',
        //    data: [[1715043600000, 678.78], [1715047200000, 545.33], [1715050800000, 788.72], [1715054400000, 406.2], [1715058000000, 744.87], [1715061600000, 466.03], [1715065200000, 337.52], [1715068800000, 845.11], [1715072400000, 396.67], [1715076000000, 470.89]],
        // }, {
        //    name: 'The Local Fishmarket',
        //    data: [[1715043600000, 1340.72], [1715047200000, 982.43], [1715050800000, 1437.99], [1715054400000, 1476.2], [1715058000000, 670.23], [1715061600000, 429.58], [1715065200000, 897.52], [1715068800000, 845.11], [1715072400000, 1275.79], [1715076000000, 1843.01]],
        // }];
        // for (let item of data) {
        //    chart.addSeries(item);
        // };
    </script>
</body>
</html>